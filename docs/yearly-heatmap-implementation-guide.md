# ì—°ê°„ íˆíŠ¸ë§µ (Yearly Contribution Graph) êµ¬í˜„ ê°€ì´ë“œ

ì´ ë¬¸ì„œëŠ” GitHub ìŠ¤íƒ€ì¼ì˜ ì—°ê°„ í™œë™ íˆíŠ¸ë§µ ì»´í¬ë„ŒíŠ¸ì˜ êµ¬í˜„ ì›ë¦¬ì™€ ì‚¬ìš© ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œ ì´ ì»´í¬ë„ŒíŠ¸ë¥¼ ì¬ì‚¬ìš©í•˜ê±°ë‚˜ ì°¸ê³ í•  ìˆ˜ ìˆë„ë¡ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

## ğŸ“‹ ëª©ì°¨
1. [ê°œìš”](#ê°œìš”)
2. [í•µì‹¬ ì›ë¦¬](#í•µì‹¬-ì›ë¦¬)
3. [ë°ì´í„° êµ¬ì¡°](#ë°ì´í„°-êµ¬ì¡°)
4. [ë ˆì´ì•„ì›ƒ ì•Œê³ ë¦¬ì¦˜](#ë ˆì´ì•„ì›ƒ-ì•Œê³ ë¦¬ì¦˜)
5. [ìƒ‰ìƒ ì‹œìŠ¤í…œ](#ìƒ‰ìƒ-ì‹œìŠ¤í…œ)
6. [í†µê³„ ê³„ì‚°](#í†µê³„-ê³„ì‚°)
7. [ì „ì²´ ì½”ë“œ](#ì „ì²´-ì½”ë“œ)
8. [ì‚¬ìš© ì˜ˆì‹œ](#ì‚¬ìš©-ì˜ˆì‹œ)
9. [ì˜ì¡´ì„±](#ì˜ì¡´ì„±)
10. [ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ì´ë“œ](#ì»¤ìŠ¤í„°ë§ˆì´ì§•-ê°€ì´ë“œ)

---

## ê°œìš”

### ë¬´ì—‡ì¸ê°€ìš”?
GitHubì˜ ì”ë””ë°­(contribution graph)ê³¼ ìœ ì‚¬í•œ ì—°ê°„ í™œë™ íˆíŠ¸ë§µ ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.
ì¼ë³„ í™œë™ ë°ì´í„°ë¥¼ ì‹œê°í™”í•˜ì—¬ ì‚¬ìš©ìì˜ ìƒì‚°ì„±ê³¼ í™œë™ íŒ¨í„´ì„ í•œëˆˆì— íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì£¼ìš” ê¸°ëŠ¥
- âœ… ì—°ê°„ 365ì¼ ë°ì´í„° ì‹œê°í™” (12ê°œì›” Ã— ê° ì›”ì˜ ì¼ìˆ˜)
- âœ… í™œë™ ê°•ë„ì— ë”°ë¥¸ 5ë‹¨ê³„ ìƒ‰ìƒ êµ¬ë¶„
- âœ… ì›”ë³„ + ì£¼ë³„ ë ˆì´ì•„ì›ƒ (2ì£¼ì”© í•œ ì¤„ì— í‘œì‹œ)
- âœ… í˜¸ë²„ ì‹œ ìƒì„¸ ì •ë³´ í‘œì‹œ
- âœ… í†µê³„ ìë™ ê³„ì‚° (ì´ ì™„ë£Œ, ìµœì¥ ì—°ì†, í˜„ì¬ ì—°ì†)
- âœ… ì—°ë„ ì„ íƒ ê¸°ëŠ¥
- âœ… íƒ€ì…ë³„ í•„í„°ë§ (todos, plans, all)
- âœ… ë‹¤í¬ëª¨ë“œ ëŒ€ì‘
- âœ… ëª¨ë°”ì¼ ì¹œí™”ì  ë””ìì¸

### ì‹¤ì œ ëª¨ìŠµ
```
1ì›”  [ì¼ì›”í™”ìˆ˜ëª©ê¸ˆí† ] [ì¼ì›”í™”ìˆ˜ëª©ê¸ˆí† ]  <- 2ì£¼ì”© í•œ ì¤„
     ğŸŸ©ğŸŸ©â¬œğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©  â¬œğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©
     ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©  ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©ğŸŸ©

2ì›”  [ì¼ì›”í™”ìˆ˜ëª©ê¸ˆí† ] [ì¼ì›”í™”ìˆ˜ëª©ê¸ˆí† ]
     ...
```

---

## í•µì‹¬ ì›ë¦¬

### 1. ë°ì´í„° ìˆ˜ì§‘ ë° ì§‘ê³„
```typescript
// 1) ì„ íƒëœ ì—°ë„ì˜ ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ ê³„ì‚°
const startDate = startOfYear(new Date(selectedYear, 0, 1))
const endDate = endOfYear(new Date(selectedYear, 0, 1))

// 2) ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì™„ë£Œëœ í•­ëª© ê°€ì ¸ì˜¤ê¸° (pagination ì‚¬ìš©)
const { data } = await supabase
  .from('todos')
  .select('date, completed')
  .gte('date', format(startDate, 'yyyy-MM-dd'))
  .lte('date', format(endDate, 'yyyy-MM-dd'))
  .eq('completed', true)

// 3) ë‚ ì§œë³„ë¡œ ì§‘ê³„í•˜ì—¬ Mapì— ì €ì¥
const contributionsMap = new Map<string, ContributionData>()
allTodos.forEach(todo => {
  const existing = contributionsMap.get(todo.date) || { date: todo.date, count: 0 }
  existing.count += 1
  contributionsMap.set(todo.date, existing)
})
```

### 2. ë‹¬ë ¥ ê·¸ë¦¬ë“œ ìƒì„±
```typescript
// ê° ì›”ì„ ìˆœíšŒí•˜ë©° ì£¼ ë‹¨ìœ„ë¡œ ê·¸ë£¹í™”
for (let monthIndex = 0; monthIndex < 12; monthIndex++) {
  const monthStart = new Date(selectedYear, monthIndex, 1)
  const monthEnd = new Date(selectedYear, monthIndex + 1, 0)
  const monthDays = eachDayOfInterval({ start: monthStart, end: monthEnd })
  
  // ì²« ë‚ ì˜ ìš”ì¼ì— ë§ì¶° ì•ìª½ íŒ¨ë”© ì¶”ê°€ (ì¼ìš”ì¼=0ë¶€í„° ì‹œì‘)
  const firstDayOfWeek = getDay(monthStart)
  const paddedDays = Array(firstDayOfWeek).fill(null).concat(monthDays)
  
  // 7ì¼ì”© ëŠì–´ì„œ ì£¼ ë‹¨ìœ„ ë°°ì—´ë¡œ ë³€í™˜
  const weeks = []
  for (let i = 0; i < paddedDays.length; i += 7) {
    weeks.push(paddedDays.slice(i, i + 7))
  }
}
```

### 3. 2ì£¼ì”© í•œ ì¤„ì— ë Œë”ë§
```typescript
// ê° ì›”ì˜ ì£¼ë¥¼ 2ê°œì”© ë¬¶ì–´ì„œ í•œ ì¤„ì— í‘œì‹œ
Array.from({ length: Math.ceil(weeks.length / 2) }).map((_, rowIndex) => {
  const firstWeek = weeks[rowIndex * 2]
  const secondWeek = weeks[rowIndex * 2 + 1]
  
  return (
    <div className="flex gap-3">
      {/* ì²« ë²ˆì§¸ ì£¼ */}
      <div className="flex gap-1">
        {firstWeek?.map(day => renderDayCell(day))}
      </div>
      
      {/* ë‘ ë²ˆì§¸ ì£¼ */}
      {secondWeek && (
        <div className="flex gap-1">
          {secondWeek.map(day => renderDayCell(day))}
        </div>
      )}
    </div>
  )
})
```

---

## ë°ì´í„° êµ¬ì¡°

### ContributionData ì¸í„°í˜ì´ìŠ¤
```typescript
interface ContributionData {
  date: string        // 'YYYY-MM-DD' í˜•ì‹
  count: number       // í•´ë‹¹ ë‚ ì§œì˜ ì´ í™œë™ ìˆ˜
  todos?: number      // todo ì™„ë£Œ ìˆ˜ (ì„ íƒì )
  plans?: number      // plan ì™„ë£Œ ìˆ˜ (ì„ íƒì )
}
```

### Props ì¸í„°í˜ì´ìŠ¤
```typescript
interface YearlyContributionGraphProps {
  type?: 'todos' | 'plans' | 'all'  // í‘œì‹œí•  ë°ì´í„° íƒ€ì…
}
```

### State ê´€ë¦¬
```typescript
const [contributions, setContributions] = useState<Map<string, ContributionData>>(new Map())
const [selectedYear, setSelectedYear] = useState(new Date().getFullYear())
const [hoveredDate, setHoveredDate] = useState<string | null>(null)
const [totalContributions, setTotalContributions] = useState(0)
const [longestStreak, setLongestStreak] = useState(0)
const [currentStreak, setCurrentStreak] = useState(0)
```

---

## ë ˆì´ì•„ì›ƒ ì•Œê³ ë¦¬ì¦˜

### ì›”ë³„ ë°ì´í„° êµ¬ì¡°
```typescript
interface MonthData {
  month: number                    // 0-11 (1ì›”-12ì›”)
  weeks: (Date | null)[][]        // ì£¼ ë°°ì—´ì˜ ë°°ì—´
}

// ì˜ˆì‹œ: 2025ë…„ 1ì›”
// weeks[0] = [null, null, null, 2025-01-01, 2025-01-02, 2025-01-03, 2025-01-04]
//            (ì¼)  (ì›”)  (í™”)  (ìˆ˜)         (ëª©)         (ê¸ˆ)         (í† )
// weeks[1] = [2025-01-05, 2025-01-06, ..., 2025-01-11]
```

### ìš”ì¼ ì •ë ¬ (ì¼ìš”ì¼ ì‹œì‘)
```typescript
const weekDays = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ']

// getDay() í•¨ìˆ˜ ê²°ê³¼:
// ì¼ìš”ì¼ = 0, ì›”ìš”ì¼ = 1, ..., í† ìš”ì¼ = 6
```

### íŒ¨ë”© ë¡œì§
```typescript
// 1ì›” 1ì¼ì´ ìˆ˜ìš”ì¼(3)ì´ë©´, ì•ì— 3ì¹¸ ë¹„ìš°ê¸°
const firstDayOfWeek = getDay(monthStart)  // 3
const paddedDays = []

for (let i = 0; i < firstDayOfWeek; i++) {
  paddedDays.push(null)  // [null, null, null]
}

// ì‹¤ì œ ë‚ ì§œë“¤ ì¶”ê°€
monthDays.forEach(day => paddedDays.push(day))
// [null, null, null, 2025-01-01, 2025-01-02, ...]
```

---

## ìƒ‰ìƒ ì‹œìŠ¤í…œ

### 5ë‹¨ê³„ Intensity Level
```typescript
const getContributionLevel = (count: number): string => {
  if (count === 0) return 'bg-gray-100 dark:bg-gray-800'  // í™œë™ ì—†ìŒ
  if (count <= 2)  return 'bg-green-200'                  // ë§¤ìš° ì•½í•¨
  if (count <= 4)  return 'bg-green-400'                  // ì•½í•¨
  if (count <= 6)  return 'bg-green-500'                  // ë³´í†µ
  return 'bg-green-600'                                   // ê°•í•¨
}
```

### ìƒ‰ìƒ ì»¤ìŠ¤í„°ë§ˆì´ì§• ì˜ˆì‹œ
```typescript
// íŒŒë€ìƒ‰ í…Œë§ˆë¡œ ë³€ê²½
if (count === 0) return 'bg-gray-100'
if (count <= 2)  return 'bg-blue-200'
if (count <= 4)  return 'bg-blue-400'
if (count <= 6)  return 'bg-blue-500'
return 'bg-blue-600'

// íˆíŠ¸ë§µ ìŠ¤íƒ€ì¼ (ë¹¨ê°•-ë…¸ë‘)
if (count === 0) return 'bg-gray-100'
if (count <= 2)  return 'bg-yellow-200'
if (count <= 4)  return 'bg-orange-300'
if (count <= 6)  return 'bg-orange-500'
return 'bg-red-500'
```

### ì…€ ìŠ¤íƒ€ì¼
```typescript
<div
  className={`
    w-3 h-3                              // í¬ê¸°: 12px Ã— 12px
    rounded-sm                            // ë‘¥ê·¼ ëª¨ì„œë¦¬
    cursor-pointer                        // ì»¤ì„œ í¬ì¸í„°
    transition-all                        // ë¶€ë“œëŸ¬ìš´ ì „í™˜
    hover:ring-2                          // í˜¸ë²„ ì‹œ í…Œë‘ë¦¬
    hover:ring-offset-1 
    hover:ring-gray-400
    ${getContributionLevel(count)}        // ë™ì  ë°°ê²½ìƒ‰
  `}
  onMouseEnter={() => setHoveredDate(dateStr)}
  onMouseLeave={() => setHoveredDate(null)}
  title={`${format(day, 'yyyyë…„ Mì›” dì¼')}: ${count}ê°œ ì™„ë£Œ`}
/>
```

---

## í†µê³„ ê³„ì‚°

### 1. ì´ ì™„ë£Œ ìˆ˜ (Total Contributions)
```typescript
let total = 0
contributionsMap.forEach(contribution => {
  total += contribution.count
})
setTotalContributions(total)
```

### 2. ìµœì¥ ì—°ì† ê¸°ë¡ (Longest Streak)
```typescript
const calculateLongestStreak = (contributionsMap: Map<string, ContributionData>) => {
  const sortedDates = Array.from(contributionsMap.keys()).sort()
  
  let maxStreak = 0
  let currentStreak = 0
  let lastDate: Date | null = null
  
  sortedDates.forEach(dateStr => {
    const currentDate = new Date(dateStr)
    
    if (lastDate) {
      const diffDays = Math.floor(
        (currentDate.getTime() - lastDate.getTime()) / (1000 * 60 * 60 * 24)
      )
      
      if (diffDays === 1) {
        currentStreak++  // ì—°ì†ëœ ë‚ ì§œ
      } else {
        maxStreak = Math.max(maxStreak, currentStreak)
        currentStreak = 1  // ìƒˆë¡œìš´ ì—°ì† ì‹œì‘
      }
    } else {
      currentStreak = 1
    }
    
    lastDate = currentDate
  })
  
  maxStreak = Math.max(maxStreak, currentStreak)
  return maxStreak
}
```

### 3. í˜„ì¬ ì—°ì† ê¸°ë¡ (Current Streak)
```typescript
const calculateCurrentStreak = () => {
  const today = format(new Date(), 'yyyy-MM-dd')
  const yesterday = format(subDays(new Date(), 1), 'yyyy-MM-dd')
  
  // ì˜¤ëŠ˜ ë˜ëŠ” ì–´ì œì— í™œë™ì´ ì—†ìœ¼ë©´ ì—°ì† ê¸°ë¡ ì¢…ë£Œ
  if (!contributionsMap.has(today) && !contributionsMap.has(yesterday)) {
    return 0
  }
  
  // ... ìœ„ì˜ ìµœì¥ ì—°ì†ê³¼ ë™ì¼í•œ ë¡œì§ìœ¼ë¡œ í˜„ì¬ ì—°ì† ê³„ì‚°
}
```

---

## ì „ì²´ ì½”ë“œ

### YearlyContributionGraph.tsx
```typescript
'use client'

import { useState, useEffect, useCallback } from 'react'
import { format, subDays, startOfYear, endOfYear, eachDayOfInterval, getDay } from 'date-fns'
import { ko } from 'date-fns/locale'
import { supabase } from '@/lib/supabase/client'

interface ContributionData {
  date: string
  count: number
  todos?: number
  plans?: number
}

interface YearlyContributionGraphProps {
  type?: 'todos' | 'plans' | 'all'
}

export default function YearlyContributionGraph({ type = 'all' }: YearlyContributionGraphProps) {
  const [contributions, setContributions] = useState<Map<string, ContributionData>>(new Map())
  const [selectedYear, setSelectedYear] = useState(new Date().getFullYear())
  const [hoveredDate, setHoveredDate] = useState<string | null>(null)
  const [totalContributions, setTotalContributions] = useState(0)
  const [longestStreak, setLongestStreak] = useState(0)
  const [currentStreak, setCurrentStreak] = useState(0)

  // ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (Pagination ì‚¬ìš©)
  const fetchYearlyData = useCallback(async () => {
    const startDate = startOfYear(new Date(selectedYear, 0, 1))
    const endDate = endOfYear(new Date(selectedYear, 0, 1))
    
    const contributionsMap = new Map<string, ContributionData>()
    
    if (type === 'todos' || type === 'all') {
      let allTodos: Array<{ date: string; completed: boolean }> = []
      let page = 0
      const pageSize = 1000
      let hasMore = true

      while (hasMore) {
        const { data: todosData } = await supabase
          .from('todos')
          .select('date, completed')
          .gte('date', format(startDate, 'yyyy-MM-dd'))
          .lte('date', format(endDate, 'yyyy-MM-dd'))
          .eq('completed', true)
          .range(page * pageSize, (page + 1) * pageSize - 1)

        if (todosData && todosData.length > 0) {
          allTodos = [...allTodos, ...todosData]
          hasMore = todosData.length === pageSize
          page++
        } else {
          hasMore = false
        }
      }

      allTodos.forEach(todo => {
        const existing = contributionsMap.get(todo.date) || { 
          date: todo.date, count: 0, todos: 0, plans: 0 
        }
        existing.todos = (existing.todos || 0) + 1
        existing.count = existing.todos + (existing.plans || 0)
        contributionsMap.set(todo.date, existing)
      })
    }

    // plansë„ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬...

    setContributions(contributionsMap)
    calculateStatistics(contributionsMap)
  }, [selectedYear, type])

  useEffect(() => {
    fetchYearlyData()
  }, [fetchYearlyData])

  // í†µê³„ ê³„ì‚°
  const calculateStatistics = (contributionsMap: Map<string, ContributionData>) => {
    let total = 0
    let maxStreak = 0
    let currentStreak = 0
    let lastDate: Date | null = null
    
    const sortedDates = Array.from(contributionsMap.keys()).sort()
    
    sortedDates.forEach(dateStr => {
      const contribution = contributionsMap.get(dateStr)!
      total += contribution.count
      
      const currentDate = new Date(dateStr)
      
      if (lastDate) {
        const diffDays = Math.floor(
          (currentDate.getTime() - lastDate.getTime()) / (1000 * 60 * 60 * 24)
        )
        if (diffDays === 1) {
          currentStreak++
        } else {
          maxStreak = Math.max(maxStreak, currentStreak)
          currentStreak = 1
        }
      } else {
        currentStreak = 1
      }
      
      lastDate = currentDate
    })
    
    maxStreak = Math.max(maxStreak, currentStreak)
    
    // í˜„ì¬ ì—°ì† í™•ì¸
    const today = format(new Date(), 'yyyy-MM-dd')
    const yesterday = format(subDays(new Date(), 1), 'yyyy-MM-dd')
    
    if (!contributionsMap.has(today) && !contributionsMap.has(yesterday)) {
      currentStreak = 0
    }
    
    setTotalContributions(total)
    setLongestStreak(maxStreak)
    setCurrentStreak(currentStreak)
  }

  // ìƒ‰ìƒ ê³„ì‚°
  const getContributionLevel = (count: number): string => {
    if (count === 0) return 'bg-gray-100 dark:bg-gray-800'
    if (count <= 2) return 'bg-green-200'
    if (count <= 4) return 'bg-green-400'
    if (count <= 6) return 'bg-green-500'
    return 'bg-green-600'
  }

  // ì—°ê°„ ê·¸ë¦¬ë“œ ë Œë”ë§
  const renderYearGrid = () => {
    const monthsData: { month: number; weeks: (Date | null)[][] }[] = []
    
    for (let monthIndex = 0; monthIndex < 12; monthIndex++) {
      const monthStart = new Date(selectedYear, monthIndex, 1)
      const monthEnd = new Date(selectedYear, monthIndex + 1, 0)
      const monthDays = eachDayOfInterval({ start: monthStart, end: monthEnd })
      
      // ì²« ë‚ ì˜ ìš”ì¼ì— ë§ì¶° íŒ¨ë”© ì¶”ê°€
      const firstDayOfWeek = getDay(monthStart)
      const paddedDays: (Date | null)[] = []
      
      for (let i = 0; i < firstDayOfWeek; i++) {
        paddedDays.push(null)
      }
      
      monthDays.forEach(day => paddedDays.push(day))
      
      // 7ì¼ì”© ëŠì–´ì„œ ì£¼ ë°°ì—´ë¡œ
      const weeks: (Date | null)[][] = []
      for (let i = 0; i < paddedDays.length; i += 7) {
        weeks.push(paddedDays.slice(i, i + 7))
      }
      
      monthsData.push({ month: monthIndex, weeks })
    }
    
    const months = ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”']
    const weekDays = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ']
    
    return (
      <div className="pb-4">
        <div className="w-full">
          {/* ìš”ì¼ í—¤ë” */}
          <div className="flex sticky top-0 bg-white z-10 pb-2 mb-2 border-b">
            <div className="w-12 flex-shrink-0"></div>
            <div className="flex gap-3">
              {/* ì²« ë²ˆì§¸ ì£¼ */}
              <div className="flex gap-1">
                {weekDays.map(day => (
                  <div key={`week1-${day}`} className="w-3 text-[10px] text-gray-600 text-center">
                    {day}
                  </div>
                ))}
              </div>
              {/* ë‘ ë²ˆì§¸ ì£¼ */}
              <div className="flex gap-1">
                {weekDays.map(day => (
                  <div key={`week2-${day}`} className="w-3 text-[10px] text-gray-600 text-center">
                    {day}
                  </div>
                ))}
              </div>
            </div>
          </div>
          
          {/* ì›”ë³„ ê·¸ë¦¬ë“œ */}
          <div className="space-y-3">
            {monthsData.map(({ month, weeks }) => (
              <div key={month} className="flex">
                {/* ì›” ë¼ë²¨ */}
                <div className="w-12 flex-shrink-0 text-xs text-gray-600 pr-2">
                  {months[month]}
                </div>
                
                {/* 2ì£¼ì”© í•œ ì¤„ì— */}
                <div className="flex-1">
                  <div className="space-y-1">
                    {Array.from({ length: Math.ceil(weeks.length / 2) }).map((_, rowIndex) => {
                      const firstWeek = weeks[rowIndex * 2]
                      const secondWeek = weeks[rowIndex * 2 + 1]
                      
                      return (
                        <div key={rowIndex} className="flex gap-3">
                          {/* ì²« ë²ˆì§¸ ì£¼ */}
                          <div className="flex gap-1">
                            {firstWeek?.map((day, dayIndex) => {
                              if (!day) {
                                return <div key={`empty-${month}-${rowIndex * 2}-${dayIndex}`} className="w-3 h-3" />
                              }
                              
                              const dateStr = format(day, 'yyyy-MM-dd')
                              const contribution = contributions.get(dateStr)
                              const count = contribution?.count || 0
                              
                              return (
                                <div
                                  key={dateStr}
                                  className={`w-3 h-3 rounded-sm cursor-pointer transition-all hover:ring-2 hover:ring-offset-1 hover:ring-gray-400 ${getContributionLevel(count)}`}
                                  onMouseEnter={() => setHoveredDate(dateStr)}
                                  onMouseLeave={() => setHoveredDate(null)}
                                  title={`${format(day, 'yyyyë…„ Mì›” dì¼')}: ${count}ê°œ ì™„ë£Œ`}
                                />
                              )
                            })}
                          </div>
                          
                          {/* ë‘ ë²ˆì§¸ ì£¼ */}
                          {secondWeek && (
                            <div className="flex gap-1">
                              {secondWeek.map((day, dayIndex) => {
                                if (!day) {
                                  return <div key={`empty-${month}-${rowIndex * 2 + 1}-${dayIndex}`} className="w-3 h-3" />
                                }
                                
                                const dateStr = format(day, 'yyyy-MM-dd')
                                const contribution = contributions.get(dateStr)
                                const count = contribution?.count || 0
                                
                                return (
                                  <div
                                    key={dateStr}
                                    className={`w-3 h-3 rounded-sm cursor-pointer transition-all hover:ring-2 hover:ring-offset-1 hover:ring-gray-400 ${getContributionLevel(count)}`}
                                    onMouseEnter={() => setHoveredDate(dateStr)}
                                    onMouseLeave={() => setHoveredDate(null)}
                                    title={`${format(day, 'yyyyë…„ Mì›” dì¼')}: ${count}ê°œ ì™„ë£Œ`}
                                  />
                                )
                              })}
                            </div>
                          )}
                        </div>
                      )
                    })}
                  </div>
                </div>
              </div>
            ))}
          </div>
          
          {/* ë²”ë¡€ ë° í†µê³„ */}
          <div className="flex flex-col gap-3 mt-4 pt-4 border-t">
            <div className="flex items-center gap-2 text-xs text-gray-600">
              <span>ì ìŒ</span>
              <div className="flex gap-1">
                <div className="w-3 h-3 rounded-sm bg-gray-100"></div>
                <div className="w-3 h-3 rounded-sm bg-green-200"></div>
                <div className="w-3 h-3 rounded-sm bg-green-400"></div>
                <div className="w-3 h-3 rounded-sm bg-green-500"></div>
                <div className="w-3 h-3 rounded-sm bg-green-600"></div>
              </div>
              <span>ë§ìŒ</span>
            </div>
            
            {/* í†µê³„ */}
            <div className="flex flex-wrap gap-3 text-xs text-gray-600">
              <div>
                <span className="font-medium">{totalContributions}</span> ì´ ì™„ë£Œ
              </div>
              <div>
                <span className="font-medium">{longestStreak}</span>ì¼ ìµœì¥ ì—°ì†
              </div>
              {currentStreak > 0 && (
                <div className="text-green-600">
                  <span className="font-medium">{currentStreak}</span>ì¼ í˜„ì¬ ì—°ì†
                </div>
              )}
            </div>
          </div>
        </div>
      </div>
    )
  }

  return (
    <div className="bg-white rounded-lg shadow-sm p-6">
      <div className="flex items-center justify-between mb-4">
        <div className="flex flex-col">
          <h2 className="text-lg font-semibold text-gray-900">
            {type === 'todos' ? 'ğŸ“ Todo ë‹¬ì„± ê¸°ë¡' : 
             type === 'plans' ? 'ğŸ¯ ê³„íš ë‹¬ì„± ê¸°ë¡' : 
             'ğŸŒ± ì—°ê°„ í™œë™ ê¸°ë¡'}
          </h2>
          <p className="text-sm text-gray-600">ì´ {totalContributions}ê°œ ë‹¬ì„±</p>
        </div>
        <select
          value={selectedYear}
          onChange={(e) => setSelectedYear(Number(e.target.value))}
          className="text-sm border rounded px-2 py-1"
        >
          {[2024, 2025, 2026].map(year => (
            <option key={year} value={year}>{year}ë…„</option>
          ))}
        </select>
      </div>
      
      {renderYearGrid()}
      
      {/* í˜¸ë²„ íˆ´íŒ */}
      {hoveredDate && contributions.get(hoveredDate) && (
        <div className="mt-4 p-3 bg-gray-100 rounded-lg">
          <div className="text-sm font-medium">
            {format(new Date(hoveredDate), 'yyyyë…„ Mì›” dì¼ (E)', { locale: ko })}
          </div>
          <div className="text-xs text-gray-600 mt-1">
            {type === 'todos' && `${contributions.get(hoveredDate)!.todos || 0}ê°œ í•  ì¼ ì™„ë£Œ`}
            {type === 'plans' && `${contributions.get(hoveredDate)!.plans || 0}ê°œ ê³„íš ì™„ë£Œ`}
            {type === 'all' && (
              <>
                {contributions.get(hoveredDate)!.todos || 0}ê°œ í•  ì¼ ì™„ë£Œ
                {contributions.get(hoveredDate)!.plans ? 
                  `, ${contributions.get(hoveredDate)!.plans}ê°œ ê³„íš ì™„ë£Œ` : ''}
              </>
            )}
          </div>
        </div>
      )}
    </div>
  )
}
```

---

## ì‚¬ìš© ì˜ˆì‹œ

### ê¸°ë³¸ ì‚¬ìš©
```tsx
import YearlyContributionGraph from '@/components/dashboard/YearlyContributionGraph'

export default function DashboardPage() {
  return (
    <div>
      <h1>ëŒ€ì‹œë³´ë“œ</h1>
      
      {/* Todo í™œë™ íˆíŠ¸ë§µ */}
      <YearlyContributionGraph type="todos" />
      
      {/* ê³„íš í™œë™ íˆíŠ¸ë§µ */}
      <YearlyContributionGraph type="plans" />
      
      {/* ì „ì²´ í™œë™ íˆíŠ¸ë§µ */}
      <YearlyContributionGraph type="all" />
    </div>
  )
}
```

### ì»¤ìŠ¤í…€ ë°ì´í„° ì†ŒìŠ¤
```typescript
// APIì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
const { data } = await fetch('/api/contributions?year=2025')

// Mapìœ¼ë¡œ ë³€í™˜
const contributionsMap = new Map()
data.forEach(item => {
  contributionsMap.set(item.date, {
    date: item.date,
    count: item.count
  })
})
```

---

## ì˜ì¡´ì„±

### í•„ìˆ˜ íŒ¨í‚¤ì§€
```json
{
  "dependencies": {
    "react": "^18.0.0",
    "date-fns": "^4.1.0",
    "@supabase/supabase-js": "^2.0.0"
  }
}
```

### ì„¤ì¹˜ ëª…ë ¹
```bash
npm install date-fns
npm install @supabase/supabase-js
```

### date-fns í•¨ìˆ˜ ì‚¬ìš©
```typescript
import { 
  format,           // ë‚ ì§œ í¬ë§·íŒ…
  subDays,          // Nì¼ ì „
  startOfYear,      // ì—°ë„ ì‹œì‘ì¼
  endOfYear,        // ì—°ë„ ì¢…ë£Œì¼
  eachDayOfInterval,// ê¸°ê°„ ë‚´ ëª¨ë“  ë‚ ì§œ
  getDay            // ìš”ì¼ (0-6)
} from 'date-fns'

import { ko } from 'date-fns/locale'  // í•œêµ­ì–´ ë¡œì¼€ì¼
```

---

## ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ì´ë“œ

### 1. ì…€ í¬ê¸° ë³€ê²½
```typescript
// ì‘ê²Œ (10px Ã— 10px)
className="w-2.5 h-2.5"

// ê¸°ë³¸ (12px Ã— 12px)
className="w-3 h-3"

// í¬ê²Œ (16px Ã— 16px)
className="w-4 h-4"
```

### 2. ìƒ‰ìƒ í…Œë§ˆ ë³€ê²½
```typescript
// íŒŒë€ìƒ‰ í…Œë§ˆ
const getContributionLevel = (count: number): string => {
  if (count === 0) return 'bg-gray-100'
  if (count <= 2) return 'bg-blue-200'
  if (count <= 4) return 'bg-blue-400'
  if (count <= 6) return 'bg-blue-500'
  return 'bg-blue-600'
}

// ë¹¨ê°•-ë…¸ë‘ íˆíŠ¸ë§µ
const getContributionLevel = (count: number): string => {
  if (count === 0) return 'bg-gray-100'
  if (count <= 2) return 'bg-yellow-300'
  if (count <= 4) return 'bg-orange-400'
  if (count <= 6) return 'bg-red-400'
  return 'bg-red-600'
}
```

### 3. ë ˆì´ì•„ì›ƒ ë³€ê²½

#### 1ì£¼ì”© í•œ ì¤„ì— í‘œì‹œ (ì„¸ë¡œë¡œ ê¸¸ê²Œ)
```typescript
// renderYearGrid() ë‚´ë¶€ ìˆ˜ì •
{weeks.map((week, weekIndex) => (
  <div key={weekIndex} className="flex gap-1">
    {week.map((day, dayIndex) => (
      // ê° ë‚ ì§œ ì…€ ë Œë”ë§
    ))}
  </div>
))}
```

#### ì „ì²´ ì—°ë„ë¥¼ í•œ ì¤„ë¡œ (GitHub ìŠ¤íƒ€ì¼)
```typescript
// ì „ì²´ 365ì¼ì„ ì£¼ ë‹¨ìœ„ë¡œ ì„¸ë¡œë¡œ ë°°ì¹˜
const allDays = eachDayOfInterval({ 
  start: startOfYear(new Date(selectedYear, 0, 1)), 
  end: endOfYear(new Date(selectedYear, 0, 1)) 
})

// 7ê°œì”© ë¬¶ì–´ì„œ ì„¸ë¡œ ì»¬ëŸ¼ìœ¼ë¡œ
const columns: Date[][] = Array.from({ length: 53 }, () => [])
allDays.forEach((day, index) => {
  const columnIndex = Math.floor(index / 7)
  columns[columnIndex].push(day)
})

return (
  <div className="flex gap-1">
    {columns.map((column, colIndex) => (
      <div key={colIndex} className="flex flex-col gap-1">
        {column.map(day => renderDayCell(day))}
      </div>
    ))}
  </div>
)
```

### 4. ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
```typescript
// ì…€ì— í˜ì´ë“œì¸ ì• ë‹ˆë©”ì´ì…˜
<div
  className={`
    w-3 h-3 rounded-sm
    ${getContributionLevel(count)}
    animate-fade-in
  `}
  style={{
    animationDelay: `${monthIndex * 50 + rowIndex * 20}ms`
  }}
/>

// tailwind.config.js
module.exports = {
  theme: {
    extend: {
      animation: {
        'fade-in': 'fadeIn 0.3s ease-out forwards'
      },
      keyframes: {
        fadeIn: {
          '0%': { opacity: '0', transform: 'scale(0.8)' },
          '100%': { opacity: '1', transform: 'scale(1)' }
        }
      }
    }
  }
}
```

### 5. í†µê³„ ì»¤ìŠ¤í„°ë§ˆì´ì§•
```typescript
// í‰ê·  ê³„ì‚° ì¶”ê°€
const avgDaily = totalContributions / 365

// ìµœê³  ê¸°ë¡ì¼
const maxDay = Array.from(contributions.entries())
  .reduce((max, [date, data]) => 
    data.count > max.count ? data : max
  , { count: 0, date: '' })

// ì£¼ê°„ í‰ê· 
const weeklyAvg = totalContributions / 52
```

### 6. ëª¨ë°”ì¼ ë°˜ì‘í˜•
```typescript
<div className={`
  w-3 h-3          // ë°ìŠ¤í¬íƒ‘: 12px
  sm:w-2 sm:h-2    // ëª¨ë°”ì¼: 8px
`} />

// ë˜ëŠ” 1ì£¼ì”©ë§Œ í‘œì‹œ
<div className="hidden sm:flex gap-3">
  {/* ë‘ ë²ˆì§¸ ì£¼ëŠ” ëª¨ë°”ì¼ì—ì„œ ìˆ¨ê¹€ */}
  {secondWeek && <div>...</div>}
</div>
```

---

## ì„±ëŠ¥ ìµœì í™”

### 1. Paginationìœ¼ë¡œ ëŒ€ëŸ‰ ë°ì´í„° ì²˜ë¦¬
```typescript
// 1000ê°œì”© ëŠì–´ì„œ ê°€ì ¸ì˜¤ê¸°
const pageSize = 1000
let page = 0
let hasMore = true

while (hasMore) {
  const { data } = await supabase
    .from('todos')
    .select('date, completed')
    .range(page * pageSize, (page + 1) * pageSize - 1)
  
  if (data && data.length > 0) {
    allTodos = [...allTodos, ...data]
    hasMore = data.length === pageSize
    page++
  } else {
    hasMore = false
  }
}
```

### 2. ë©”ëª¨ì´ì œì´ì…˜
```typescript
import { useMemo } from 'react'

const monthsData = useMemo(() => {
  // ì›”ë³„ ë°ì´í„° ê³„ì‚°
  return calculateMonthsData(selectedYear)
}, [selectedYear])
```

### 3. Virtual Scrolling (ì˜µì…˜)
```typescript
// ëŒ€ëŸ‰ ë°ì´í„°ì˜ ê²½ìš° react-window ì‚¬ìš©
import { FixedSizeList } from 'react-window'

<FixedSizeList
  height={600}
  itemCount={12}
  itemSize={80}
>
  {({ index, style }) => (
    <div style={style}>
      {renderMonth(index)}
    </div>
  )}
</FixedSizeList>
```

---

## ë””ë²„ê¹… íŒ

### 1. ë‚ ì§œ ë°ì´í„° í™•ì¸
```typescript
console.log('Contributions Map:', 
  Array.from(contributions.entries())
)
```

### 2. íŒ¨ë”© í™•ì¸
```typescript
console.log('First day of month:', getDay(monthStart))
console.log('Padded days:', paddedDays)
```

### 3. ì£¼ ë°°ì—´ í™•ì¸
```typescript
console.log('Weeks:', weeks.map(week => 
  week.map(day => day ? format(day, 'MM-dd') : 'null')
))
```

---

## FAQ

### Q1. ë‹¤ë¥¸ ì£¼ ì‹œì‘ì¼ë¡œ ë³€ê²½í•˜ë ¤ë©´?
```typescript
// ì›”ìš”ì¼ ì‹œì‘
const firstDayOfWeek = (getDay(monthStart) + 6) % 7

// ìš”ì¼ ë°°ì—´ë„ ìˆ˜ì •
const weekDays = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼']
```

### Q2. ë‹¤í¬ëª¨ë“œ ì§€ì›ì€?
```typescript
// Tailwind dark: í´ë˜ìŠ¤ ì‚¬ìš©
if (count === 0) return 'bg-gray-100 dark:bg-gray-800'
if (count <= 2) return 'bg-green-200 dark:bg-green-900'
// ...
```

### Q3. ë°ì´í„°ê°€ ë§ì•„ì„œ ëŠë ¤ìš”
- Pagination ì‚¬ìš© (ì´ë¯¸ ì ìš©ë¨)
- ë¶ˆí•„ìš”í•œ re-render ë°©ì§€ (useMemo, useCallback)
- Virtual scrolling ê³ ë ¤

### Q4. ì—¬ëŸ¬ ë°ì´í„° ì†ŒìŠ¤ë¥¼ í•©ì¹˜ë ¤ë©´?
```typescript
// ì—¬ëŸ¬ í…Œì´ë¸” ë°ì´í„° ë³‘í•©
const mergedData = new Map()

todosData.forEach(todo => {
  const existing = mergedData.get(todo.date) || { count: 0 }
  existing.count += 1
  mergedData.set(todo.date, existing)
})

plansData.forEach(plan => {
  const existing = mergedData.get(plan.date) || { count: 0 }
  existing.count += 1
  mergedData.set(plan.date, existing)
})
```

---

## ë¼ì´ì„ ìŠ¤ ë° í¬ë ˆë”§

ì´ êµ¬í˜„ì€ GitHubì˜ Contribution Graphì—ì„œ ì˜ê°ì„ ë°›ì•˜ìŠµë‹ˆë‹¤.
ììœ ë¡­ê²Œ ì‚¬ìš©, ìˆ˜ì •, ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì°¸ê³  ìë£Œ
- [GitHub Contribution Graph](https://github.com/)
- [date-fns Documentation](https://date-fns.org/)
- [Tailwind CSS](https://tailwindcss.com/)

---

## ë²„ì „ íˆìŠ¤í† ë¦¬

### v1.0.0 (2025-01-15)
- âœ… ì´ˆê¸° êµ¬í˜„
- âœ… ì›”ë³„ 2ì£¼ì”© ë ˆì´ì•„ì›ƒ
- âœ… 5ë‹¨ê³„ ìƒ‰ìƒ ì‹œìŠ¤í…œ
- âœ… í†µê³„ ê³„ì‚° (ì´/ìµœì¥/í˜„ì¬ ì—°ì†)
- âœ… í˜¸ë²„ íˆ´íŒ
- âœ… ì—°ë„ ì„ íƒ
- âœ… íƒ€ì…ë³„ í•„í„°ë§

---

**ë¬¸ì„œ ì‘ì„±ì¼**: 2025-11-15  
**ì‘ì„±ì**: Claude AI  
**í”„ë¡œì íŠ¸**: Todolist PWA Application
